on:
  issues:
    types:
      - opened
       
jobs:
  run-updater:
    runs-on: ubuntu-latest
    env:
      TOKEN: $(curl https://api.product.cycle.app/graphql -s -X POST -H "Content-Type: application/json" --data '{"query" : "mutation { login(email: \"raphael@dgraph.io\", password: \"cycle4R@pH\" ) { token } }"}' | jq -r '.data.login.token')
    steps:
    - name: Create Doc in Cycle
      run: |
        echo "Token: $TOKEN"
        feedback=$(curl https://api.product.cycle.app/graphql  -X POST -H "Content-Type: application/json" -H "Authorization: Bearer $TOKEN" --data '{"query" : "mutation { addNewDoc( title: \"from github\" doctypeId: \"RG9jdHlwZV82ZTI4YzVkYi0wMDM0LTRhNmYtODNkZi1hNTM5NThjZmFhN2I=\" productId: \"UHJvZHVjdF80NGQ0MDg0Yi1mYzYwLTQwY2UtOTk4Yi1kZjc0M2M4NTg5NWI=\") {id}"}')
        echo "feedback: $feedback"
       
